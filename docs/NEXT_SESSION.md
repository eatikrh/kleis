# Next Session Notes

**Last Updated:** December 19, 2025

---

## ğŸ¯ PRIORITY: Bourbaki Compliance Roadmap

Based on capability assessment (Dec 19, 2025), here's what's needed to increase Bourbaki coverage from ~15-20% to higher levels.

### Priority 1: Parser Fixes (Quick Wins) ğŸ”§

These are parser limitations that don't require architectural changes:

| Issue | Current | Target | Effort |
|-------|---------|--------|--------|
| **âˆ€ inside âˆ§** | `(y > 0) âˆ§ (âˆ€(x). ...)` fails | Should parse | 1-2 days |
| **Function types in quantifiers** | `âˆ€(f : â„ â†’ â„). ...` fails | Should parse | 1-2 days |
| **â†’ as implication** | Only `where` works for preconditions | Support `P â†’ Q` | 1 day |

**Impact:** Enables full Îµ-Î´ analysis definitions, nested quantifiers.

### Priority 2: Set Theory in stdlib (Foundation) ğŸ“š

Set(T) exists but operations need defining:

```kleis
// Add to stdlib/sets.kleis:
structure SetTheory(X) {
    operation (âŠ†) : Set(X) Ã— Set(X) â†’ Bool
    operation (âˆª) : Set(X) Ã— Set(X) â†’ Set(X)
    operation (âˆ©) : Set(X) Ã— Set(X) â†’ Set(X)
    operation ğ’« : Set(X) â†’ Set(Set(X))
    element âˆ… : Set(X)
    
    axiom subset_def: âˆ€(A B : Set(X)). A âŠ† B â†” âˆ€(x : X). in_set(x, A) â†’ in_set(x, B)
    axiom union_def: âˆ€(A B : Set(X), x : X). in_set(x, A âˆª B) â†” in_set(x, A) âˆ¨ in_set(x, B)
    axiom power_set_def: âˆ€(S A : Set(X)). in_set(A, ğ’«(S)) â†” A âŠ† S
}
```

**Impact:** Enables Bourbaki Vol I (Set Theory foundations).

### Priority 3: Topology in stdlib ğŸŒ

Now verified to be expressible:

```kleis
// Add to stdlib/topology.kleis:
structure TopologicalSpace(X) {
    element tau : Set(Set(X))
    
    axiom empty_open: in_set(âˆ…, tau)
    axiom full_open: in_set(X, tau)
    axiom union_closed: âˆ€(U V : Set(X)). in_set(U, tau) âˆ§ in_set(V, tau) â†’ in_set(union(U, V), tau)
    axiom intersection_closed: âˆ€(U V : Set(X)). in_set(U, tau) âˆ§ in_set(V, tau) â†’ in_set(intersect(U, V), tau)
}

structure Continuous(X, Y) over TopologicalSpace(X), TopologicalSpace(Y) {
    operation f : X â†’ Y
    axiom continuity: âˆ€(V : Set(Y)). in_set(V, tau_Y) â†’ in_set(preimage(f, V), tau_X)
}
```

**Impact:** Enables Bourbaki Vol III (Topology).

### Priority 4: Analysis Structures ğŸ“ˆ

```kleis
// Add to stdlib/analysis.kleis:
structure MetricSpace(X) {
    operation d : X Ã— X â†’ â„
    
    axiom non_negative: âˆ€(x y : X). d(x, y) >= 0
    axiom identity: âˆ€(x y : X). d(x, y) = 0 â†” x = y
    axiom symmetry: âˆ€(x y : X). d(x, y) = d(y, x)
    axiom triangle: âˆ€(x y z : X). d(x, z) <= d(x, y) + d(y, z)
}

structure Limit {
    // Requires parser fix for nested quantifiers
    axiom epsilon_delta: âˆ€(L a : â„, epsilon : â„) where epsilon > 0.
        âˆƒ(delta : â„). delta > 0
}
```

**Impact:** Enables Bourbaki Vol IV (Analysis), after parser fixes.

### Priority 5: ZFC Axioms (Long-term) ğŸ›ï¸

```kleis
// Add to stdlib/foundations/zfc.kleis:
structure ZFC {
    // Extensionality
    axiom extensionality: âˆ€(A B : Set). (âˆ€(x). in_set(x, A) â†” in_set(x, B)) â†’ A = B
    
    // Pairing
    axiom pairing: âˆ€(a b). âˆƒ(c : Set). in_set(a, c) âˆ§ in_set(b, c)
    
    // Union
    axiom union: âˆ€(F : Set(Set)). âˆƒ(U : Set). âˆ€(x). in_set(x, U) â†” âˆƒ(A : Set). in_set(A, F) âˆ§ in_set(x, A)
    
    // Power Set
    axiom power: âˆ€(A : Set). âˆƒ(P : Set). âˆ€(B : Set). in_set(B, P) â†” B âŠ† A
    
    // Infinity (requires ordinals)
    // axiom infinity: ...
}
```

**Impact:** Full foundational rigor, but Z3 verification may struggle with some axioms.

---

## âš ï¸ Fundamental Limitations (Cannot Fix Without New Backend)

| Limitation | Why | Workaround |
|------------|-----|------------|
| **Induction** | Z3 is SMT, not proof assistant | None - need Lean/Coq backend |
| **Limits/Convergence verification** | Undecidable for Z3 | Can state axioms, can't verify |
| **Type-level arithmetic** | No `Vec(m+n)` from `Vec(m) ++ Vec(n)` | Runtime verification only |
| **Transfinite induction** | Requires ordinals + induction | Future work |

---

## âœ… Recently Completed

### Operator Overloading (Dec 19, 2025)
- Natural arithmetic: `3 + 4*i = complex(3, 4)` âœ…
- Type-directed lowering working
- 17 integration tests

### Capability Assessment (Dec 19, 2025)
- Verified Kleis capabilities against Bourbaki
- Found more works than expected (~15-20% not 5%)
- Documented real limitations

---

## ğŸ“Š Current Stats

| Metric | Value |
|--------|-------|
| Tests | 663+ passing |
| Commits | 840+ |
| ADRs | 23 |
| Grammar | v0.8 |
| Unique Cloners | 505+ |
| Bourbaki Coverage | ~15-20% (axiomatic) |

---

## ğŸ—ï¸ Architecture Notes

### Operator Overloading Pipeline

```
Parser â†’ Type Inference â†’ Lowering â†’ Z3 Backend
                              â†“
              Rewrites: plus(â„‚, â„‚) â†’ complex_add
                        times(â„, â„‚) â†’ complex_mul(lift, _)
```

### Bourbaki Coverage Path

```
Current: Basic Algebra (Groups, Rings, Fields, Vector Spaces)
    â†“ Priority 1-2 (parser + set theory)
Next: Set Theory foundations
    â†“ Priority 3
Next: Topology (open sets, continuity)
    â†“ Priority 4
Next: Analysis (limits, metric spaces)
    â†“ Priority 5
Long-term: ZFC foundations
    â†“ New backend
Ultimate: Induction, transfinite, category theory
```

---

*See `docs/CAPABILITY_ASSESSMENT.md` for full analysis.*
